(()=>{"use strict";var e=document.querySelector("#card-template").content;function t(t,o,n){var r=e.querySelector(".card").cloneNode(!0),c=r.querySelector(".card__title"),a=r.querySelector(".card__image");a.src=t.link,a.alt="Фото. Пейзаж. ".concat(t.name),c.textContent=t.name,r.querySelector(".card__delete-button").addEventListener("click",(function(){var e;(e=t,fetch("https://nomoreparties.co/v1/wff-cohort-16/cards/".concat(e._id),{method:"DELETE",headers:{authorization:"03a967f6-55ee-4e4e-b7f8-c5d21e5db7dc","Content-Type":"application/json"}})).then((function(){r.remove()}))})),a.addEventListener("click",(function(){return o(a,c.textContent)}));var i=r.querySelector(".card__like-counter");i.textContent=t.likes.length;var u=r.querySelector(".card__like-button");t.likes.some((function(e){return"9ba15da7537acf3e06b7d4bc"===e._id}))&&u.classList.add("card__like-button_is-active");var p;return p=!!u.classList.contains("card__like-button_is-active"),u.addEventListener("click",(function(){n(u,p,i,t)})),r}function o(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",r)}function n(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",r)}function r(e){"Escape"===e.key&&n(document.querySelector(".popup_is-opened"))}function c(e,t){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove("button_inactive"),t.removeAttribute("disabled")):(t.classList.add("button_inactive"),t.setAttribute("disabled",""))}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var i=document.querySelector(".popup_type_image"),u=document.querySelector(".popup_type_image .popup__content .popup__image"),p=document.querySelector(".popup_type_image .popup__content .popup__caption"),l=document.querySelector(".profile__edit-button"),s=document.querySelector(".page .content .places__list"),d=(document.querySelector("#card-template").content,document.querySelector(".popup_type_edit")),f=document.querySelector(".profile__add-button"),_=document.querySelector(".popup_type_new-card"),m=document.querySelectorAll(".popup"),y=document.querySelector(".popup__form"),v=document.querySelector(".popup__input_type_name"),h=document.querySelector(".popup__input_type_description"),b=document.querySelector(".popup_type_new-card").querySelector(".popup_type_new-card .popup__content .popup__form"),S=document.querySelector(".popup__input_type_card-name"),q=document.querySelector(".popup__input_type_url"),g=document.querySelector(".profile__title"),k=document.querySelector(".profile__description"),L=document.querySelector(".profile__image"),E=document.querySelector(".profile__image-edit"),C=document.querySelector(".popup_type_edit-avatar"),j=document.querySelector(".popup_type_edit-avatar .popup__content .popup__form .popup__input_type_url"),w=document.querySelector(".popup_type_edit-avatar .popup__content .popup__form");function A(e){document.querySelector(".popup__button").textContent=e?"Сохранение...":"Сохранить"}function x(e,t,o,n){var r;e.classList.toggle("card__like-button_is-active"),!1==!e.classList.contains("card__like-button_is-active")?(console.log("лАЙКАЕМ!"),(r=n,fetch("https://nomoreparties.co/v1/wff-cohort-16/cards/likes/".concat(r._id),{method:"PUT",headers:{authorization:"03a967f6-55ee-4e4e-b7f8-c5d21e5db7dc","Content-Type":"application/json"},body:JSON.stringify({likes:r.likes,_id:r._id})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.log("Ошибка. Запрос не выполнен: ",e)}))).then((function(e){o.textContent=e.likes.length}))):function(e){return fetch("https://nomoreparties.co/v1/wff-cohort-16/cards/likes/".concat(e._id),{method:"DELETE",headers:{authorization:"03a967f6-55ee-4e4e-b7f8-c5d21e5db7dc"},body:JSON.stringify({likes:e.likes,_id:e._id})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.log("Ошибка. Запрос не выполнен: ",e)}))}(n).then((function(e){o.textContent=e.likes.length}))}function T(e,t){u.src=e.src,u.alt=e.alt,p.textContent=t,o(i)}Promise.all([fetch("https://nomoreparties.co/v1/wff-cohort-16/users/me",{headers:{authorization:"03a967f6-55ee-4e4e-b7f8-c5d21e5db7dc"}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.log("Ошибка. Запрос не выполнен: ",e)})),fetch("https://nomoreparties.co/v1/wff-cohort-16/cards",{headers:{authorization:"03a967f6-55ee-4e4e-b7f8-c5d21e5db7dc"}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.log("Ошибка. Запрос не выполнен: ",e)}))]).then((function(e){var o,n,r=(n=2,function(e){if(Array.isArray(e))return e}(o=e)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,r,c,a,i=[],u=!0,p=!1;try{if(c=(o=o.call(e)).next,0===t){if(Object(o)!==o)return;u=!1}else for(;!(u=(n=c.call(o)).done)&&(i.push(n.value),i.length!==t);u=!0);}catch(e){p=!0,r=e}finally{try{if(!u&&null!=o.return&&(a=o.return(),Object(a)!==a))return}finally{if(p)throw r}}return i}}(o,n)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?a(e,t):void 0}}(o,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=r[0],i=r[1];g.textContent=c.name,k.textContent=c.about,L.setAttribute("style","background-image: url(".concat(c.avatar,")")),i.forEach((function(e){var o=t(e,T,x);s.append(o);var n=o.querySelector(".card__delete-button");"9ba15da7537acf3e06b7d4bc"!==e.owner._id&&n.classList.add("hidden")}))})),E.addEventListener("click",(function(){o(C)})),l.addEventListener("click",(function(){o(d),v.value=g.textContent,h.value=k.textContent})),f.addEventListener("click",(function(){o(_)})),m.forEach((function(e){e.addEventListener("click",(function(t){(t.target.classList.contains("popup")||t.target.classList.contains("popup__close"))&&n(e)}))})),y.addEventListener("submit",(function(e){e.preventDefault();var t,o={name:"",about:"",avatar:""};o.name=v.value,o.about=h.value,A(!0),(t=o,fetch("https://nomoreparties.co/v1/wff-cohort-16/users/me",{method:"PATCH",headers:{authorization:"03a967f6-55ee-4e4e-b7f8-c5d21e5db7dc","Content-Type":"application/json"},body:JSON.stringify({name:t.name,about:t.about})})).finally((function(){A(!1)})),g.textContent=v.value,k.textContent=h.value,n(document.querySelector(".popup_is-opened"))})),b.addEventListener("submit",(function(e){e.preventDefault();var o,r={name:"",link:""};r.name=S.value,r.link=q.value,A(!0),(o=r,fetch("https://nomoreparties.co/v1/wff-cohort-16/cards",{method:"POST",headers:{authorization:"03a967f6-55ee-4e4e-b7f8-c5d21e5db7dc","Content-Type":"application/json"},body:JSON.stringify({name:o.name,about:o.about,link:o.link})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.log("Ошибка. Запрос не выполнен: ",e)}))).then((function(e){var o=t(e,T,x);s.prepend(o)})).finally((function(){A(!1)})),n(document.querySelector(".popup_is-opened")),S.value="",q.value=""})),w.addEventListener("submit",(function(e){e.preventDefault();var t,o={avatar:""};o.avatar=j.value,A(!0),(t=o,fetch("https://nomoreparties.co/v1/wff-cohort-16/users/me/avatar",{method:"PATCH",headers:{authorization:"03a967f6-55ee-4e4e-b7f8-c5d21e5db7dc","Content-Type":"application/json"},body:JSON.stringify({avatar:t.avatar})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.log("Ошибка. Запрос не выполнен: ",e)}))).then((function(e){L.setAttribute("style","background-image: url(".concat(e.avatar,")"))})).finally((function(){A(!1)})),n(document.querySelector(".popup_is-opened"))})),Array.from(document.querySelectorAll(".popup__form")).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e){var t=Array.from(e.querySelectorAll(".popup__input")),o=e.querySelector(".popup__button");c(t,o),t.forEach((function(n){n.addEventListener("input",(function(){!function(e,t){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?function(e,t){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.remove("form__input_type_error"),o.classList.remove("form__input-error_active"),o.textContent=""}(e,t):function(e,t,o){var n=e.querySelector(".".concat(t.id,"-error"));t.classList.add("form__input_type_error"),n.textContent=o,n.classList.add("form__input-error_active")}(e,t,t.validationMessage)}(e,n),c(t,o)}))}))}(e)})),console.log("Hello, World!")})();
//# sourceMappingURL=main.js.map